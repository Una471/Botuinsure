<!DOCTYPE html>
<html>
<head>
    <title>Test PDF Upload</title>
</head>
<body>
    <h2>Test PDF Upload Directly</h2>
    <input type="file" id="pdfInput" accept=".pdf">
    <div id="result" style="margin-top: 20px; padding: 20px; border: 1px solid #ccc; background: #f9f9f9;"></div>
    
    <script>
        document.getElementById('pdfInput').onchange = async (e) => {
            const file = e.target.files[0];
            if (!file) return;
            
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `Processing ${file.name} (${(file.size / 1024).toFixed(0)}KB)...`;
            
            const reader = new FileReader();
            reader.onload = async () => {
                const base64 = reader.result.split(',')[1];
                
                try {
                    resultDiv.innerHTML += '<br>Sending to API...';
                    
                    const res = await fetch('https://botuinsure.vercel.app/api/parse-insurance-pdf', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 
                            content: base64,
                            filename: file.name
                        })
                    });
                    
                    const text = await res.text();
                    resultDiv.innerHTML += `<br><strong>Status: ${res.status}</strong>`;
                    
                    try {
                        const json = JSON.parse(text);
                        resultDiv.innerHTML += `<br><pre>${JSON.stringify(json, null, 2)}</pre>`;
                    } catch {
                        resultDiv.innerHTML += `<br><pre>${text.substring(0, 1000)}</pre>`;
                    }
                } catch (error) {
                    resultDiv.innerHTML += `<br><strong>Error:</strong> ${error.message}`;
                }
            };
            reader.readAsDataURL(file);
        };
    </script>
</body>
</html>